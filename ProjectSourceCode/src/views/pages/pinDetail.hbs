{{> nav }}

<div class="container py-5" style="background-color: #f4f4f4; min-height: 100vh;">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">

      <div class="card shadow-sm p-4 rounded-4 mb-4" style="background-color: white;">
        <h2 class="text-center fw-bold mb-4" style="font-size: 1.8rem;">ğŸ“ Pin Gallery: ID {{pinId}}</h2>

        <!-- Combined Upload + Comment Form -->
        <form action="/pin/{{pinId}}/upload" method="POST" enctype="multipart/form-data" class="mb-4">
          <div class="mb-3">
            <label for="image" class="form-label fw-semibold">ğŸ“¸ Choose an Image</label>
            <input type="file" name="image" id="image" class="form-control" required>
          </div>
          <div class="mb-3">
            <label for="caption" class="form-label fw-semibold">ğŸ’¬ Add a Caption</label>
            <textarea name="caption" id="caption" rows="2" class="form-control" placeholder="Write a caption..." required></textarea>
          </div>
          <button class="btn btn-primary w-100" type="submit">Upload Post</button>
        </form>
      </div>

      <!-- Instagram-Style Feed -->
      {{#each images}}
        <div class="card shadow-sm mb-4 rounded-4 overflow-hidden" style="background-color: white;">
          <img src="/uploads/{{this.image_path}}" alt="Uploaded Image" class="w-100" style="object-fit: cover; max-height: 500px;" />
          <div class="p-3">
            {{#each ../comments}}
              {{#if (eq this.image_path ../this.image_path)}}
                <p class="mb-1 text-dark"><strong>ğŸ“</strong> {{this.comment}}</p>
                <small class="text-muted">{{this.created_at}}</small>
              {{/if}}
            {{/each}}
          </div>
        </div>
      {{/each}}

      <!-- Navigation Buttons -->
      <div class="text-center mt-5">
        <a href="/" class="btn btn-outline-secondary me-2">ğŸ  Home</a>
        <a href="/logout" class="btn btn-outline-danger">ğŸšª Logout</a>
      </div>

    </div>
  </div>
</div>
